import { jwtDecode } from "jwt-decode";

const isValidEmail = (decoded, checkEmail) => {
  return decoded.email === checkEmail;
};

const isValidTime = (decoded) => {
  // const createTime = decoded.iat;
  const dueTime = decoded.exp;
  const currentTime = Math.round(Date.now() / 1000);
  return currentTime < dueTime;
};

export const isValidJwtToken = (token, checkEmail) => {
  const decoded = jwtDecode(token);
  console.log(decoded);
  
  // isValidTime(decoded);
  if (isValidEmail(decoded, checkEmail) && isValidTime(decoded)) {
    return true;
  } else {
    return false;
  }
};
